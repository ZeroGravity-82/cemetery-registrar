{% extends 'logged.html.twig' %}

{% block title %}Захоронения{% endblock %}

{% block body %}
  {{ parent() }}

  <div class="mb-2 mb-lg-2">
    <p class="pt-2 fs-5 fw-bold text-success">Захоронения</p>

    {% include 'burial/_toolbar.html.twig' %}

    <div class="table-responsive">
      <table class="table table-sm table-hover caption-top">
        <thead class="table-light align-middle">
          <tr>
            <th>Ф.И.О.</th>
            <th>Код</th>
            <th>Дата рождения</th>
            <th>Дата смерти</th>
            <th>Дата захоронения</th>
            <th>Возраст</th>
            <th>Место захоронения</th>
            <th>Заказчик</th>
            <th>Адрес заказчика</th>
            <th>Телефон заказчика</th>
          </tr>
        </thead>
        <tbody>
          {% for burialViewListItem in burialViewList.burialViewListItems %}
            <tr data-id="{{ burialViewListItem.id }}">
            <td>{{- burialViewListItem.deceasedNaturalPersonFullName -}}</td>
            <td class="text-end">
              {{- burialViewListItem.code -}}
            </td>
            <td>{{- burialViewListItem.deceasedNaturalPersonBornAt is empty ? '' : burialViewListItem.deceasedNaturalPersonBornAt|date('d.m.Y') -}}</td>
            <td>{{- burialViewListItem.deceasedDiedAt              is empty ? '' : burialViewListItem.deceasedDiedAt|date('d.m.Y') -}}</td>
            <td>{{- burialViewListItem.buriedAt                    is empty ? '' : burialViewListItem.buriedAt|date('d.m.Y H:i') -}}</td>
            <td>{{- burialViewListItem.deceasedAge                 is empty ? '' : burialViewListItem.deceasedAge -}}</td>
            <td>
              {% if burialViewListItem.burialPlaceType == constant('Cemetery\\Registrar\\Domain\\BurialPlace\\GraveSite\\GraveSite::CLASS_SHORTCUT') %}
                {{- burialViewListItem.burialPlaceGraveSiteCemeteryBlockName is empty ? '' : 'квартал '~burialViewListItem.burialPlaceGraveSiteCemeteryBlockName -}}
                {{- burialViewListItem.burialPlaceGraveSiteRowInBlock        is empty ? '' : ', ряд '~burialViewListItem.burialPlaceGraveSiteRowInBlock -}}
                {{- burialViewListItem.burialPlaceGraveSitePositionInRow     is empty ? '' : ', место '~burialViewListItem.burialPlaceGraveSitePositionInRow -}}
              {% elseif burialViewListItem.burialPlaceType == constant('Cemetery\\Registrar\\Domain\\BurialPlace\\ColumbariumNiche\\ColumbariumNiche::CLASS_SHORTCUT') %}
                {{- burialViewListItem.burialPlaceColumbariumNicheColumbariumName  is empty ? '' : 'колумбарий '~burialViewListItem.burialPlaceColumbariumNicheColumbariumName -}}
                {{- burialViewListItem.burialPlaceColumbariumNicheRowInColumbarium is empty ? '' : ', ряд '~burialViewListItem.burialPlaceColumbariumNicheRowInColumbarium -}}
                {{- burialViewListItem.burialPlaceColumbariumNicheNumber           is empty ? '' : ', ниша '~burialViewListItem.burialPlaceColumbariumNicheNumber -}}
              {% elseif burialViewListItem.burialPlaceType == constant('Cemetery\\Registrar\\Domain\\BurialPlace\\MemorialTree\\MemorialTree::CLASS_SHORTCUT') %}
                {{- burialViewListItem.burialPlaceMemorialTreeNumber is empty ? '' : 'сосна '~burialViewListItem.burialPlaceMemorialTreeNumber -}}
              {% endif %}
            </td>
            <td>
              {% if burialViewListItem.customerType == constant('Cemetery\\Registrar\\Domain\\NaturalPerson\\NaturalPerson::CLASS_SHORTCUT') %}
                {{- burialViewListItem.customerNaturalPersonFullName is empty ? '' : burialViewListItem.customerNaturalPersonFullName -}}
              {% elseif burialViewListItem.customerType == constant('Cemetery\\Registrar\\Domain\\Organization\\SoleProprietor\\SoleProprietor::CLASS_SHORTCUT') %}
                {{- burialViewListItem.customerSoleProprietorName is empty ? '' : burialViewListItem.customerSoleProprietorName -}}
              {% elseif burialViewListItem.customerType == constant('Cemetery\\Registrar\\Domain\\Organization\\JuristicPerson\\JuristicPerson::CLASS_SHORTCUT') %}
                {{- burialViewListItem.customerJuristicPersonName is empty ? '' : burialViewListItem.customerJuristicPersonName -}}
              {% endif %}
            </td>
            <td>
              {% if burialViewListItem.customerType == constant('Cemetery\\Registrar\\Domain\\NaturalPerson\\NaturalPerson::CLASS_SHORTCUT') %}
                {{- burialViewListItem.customerNaturalPersonAddress is empty ? '' : burialViewListItem.customerNaturalPersonAddress -}}
              {% elseif burialViewListItem.customerType == constant('Cemetery\\Registrar\\Domain\\Organization\\SoleProprietor\\SoleProprietor::CLASS_SHORTCUT') %}
                {{- burialViewListItem.customerSoleProprietorRegistrationAddress is empty
                  ? burialViewListItem.customerSoleProprietorActualLocationAddress is empty ? '' : burialViewListItem.customerSoleProprietorActualLocationAddress
                  : burialViewListItem.customerSoleProprietorRegistrationAddress -}}
              {% elseif burialViewListItem.customerType == constant('Cemetery\\Registrar\\Domain\\Organization\\JuristicPerson\\JuristicPerson::CLASS_SHORTCUT') %}
                {{- burialViewListItem.customerJuristicPersonLegalAddress is empty
                  ? burialViewListItem.customerJuristicPersonPostalAddress is empty ? '' : burialViewListItem.customerJuristicPersonPostalAddress
                  : burialViewListItem.customerJuristicPersonLegalAddress -}}
              {% endif %}
            </td>
            <td>
              {% if burialViewListItem.customerType == constant('Cemetery\\Registrar\\Domain\\NaturalPerson\\NaturalPerson::CLASS_SHORTCUT') %}
                {{- burialViewListItem.customerNaturalPersonPhone is empty ? '' : burialViewListItem.customerNaturalPersonPhone -}}
              {% elseif burialViewListItem.customerType == constant('Cemetery\\Registrar\\Domain\\Organization\\SoleProprietor\\SoleProprietor::CLASS_SHORTCUT') %}
                {{- burialViewListItem.customerSoleProprietorPhone is empty ? '' : burialViewListItem.customerSoleProprietorPhone -}}
              {% elseif burialViewListItem.customerType == constant('Cemetery\\Registrar\\Domain\\Organization\\JuristicPerson\\JuristicPerson::CLASS_SHORTCUT') %}
                {{- burialViewListItem.customerJuristicPersonPhone is empty ? '' : burialViewListItem.customerJuristicPersonPhone -}}
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  {% include 'burial/_modal_burial_new.html.twig' %}
  {% include 'burial/_modal_burial_edit.html.twig' %}

{% endblock %}

{% block javascripts %}
  {{ parent() }}

  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="/js/burial-index.js"></script>
{% endblock %}